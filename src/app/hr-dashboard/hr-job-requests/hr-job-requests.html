<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Project Manager Job Requests</title>

<!-- FontAwesome for icons -->
<link
    rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css"
    crossorigin="anonymous"
    referrerpolicy="no-referrer"
/>
</head>
<body>
<div class="pm-job-requests-container">
    <!-- Header Section -->
    <section class="header-section">
        <h1>HR Job Requests</h1>
        <p>Manage all your allocated job requests efficiently</p>
    </section>

    <!-- Stats Section -->
    <section class="stats-grid">
        <div class="stat-item">
            <div class="stat-number">{{countOfjobRequests}}</div>
            <div class="stat-label">Incoming Job Requests</div>
        </div>
        <div class="stat-item">
            <div class="stat-number">{{countOfPendingJobRequests}}</div>
            <div class="stat-label">Pending</div>
        </div>
        <div class="stat-item">
            <div class="stat-number">{{countOfPostedJobs}}</div>
            <div class="stat-label">Posted On Job Portal</div>
        </div>
    </section>

    <!-- Filter Buttons -->
    <section class="filter-buttons">
        <button
          class="filter-btn"
          [class.active]="selectedFilter === 'all'"
          (click)="applyFilter('all')"
        >
          All
        </button>

        <button
          class="filter-btn"
          [class.active]="selectedFilter === 'pending'"
          (click)="applyFilter('pending')"
        >
          Pending
        </button>

        <button
          class="filter-btn"
          [class.active]="selectedFilter === 'posted'"
          (click)="applyFilter('posted')"
        >
          Posted
        </button>
    </section>

    <!-- Job Requests Cards -->
    <!-- âœ… FIXED: @for should be INSIDE the cards-grid section -->
    <section class="cards-grid" id="jobRequestsGrid">
        @for (item of filteredJobRequests; track item.jobRequestId) {
            <div class="card" data-status="incoming">
              <div class="card-header">
                <div>
                  <div class="card-title">{{ item.title }}</div>
                  <div class="card-subtitle">{{ item.jobRequestId }}</div>
                </div>
                <span class="status-badge" [ngClass]="getStatusClass(item.status)">
                  {{ getStatusLabel(item.status) }}
                </span>
              </div>
              <div class="card-content">
                <div class="info-row">
                  <span class="info-label">Description:</span>
                  <span class="info-value">{{ item.description }}</span>
                </div>
                <div class="info-row">
                  <span class="info-label">Skills:</span>
                  <span class="info-value">{{ item.skills }}</span>
                </div>
                <div class="info-row">
                  <span class="info-label">Experience:</span>
                  <span class="info-value">{{ item.minExperience }} - {{ item.maxExperience }} years</span>
                </div>
                <div class="info-row">
                  <span class="info-label">CTC:</span>
                  <span class="info-value">{{ item.minCtc }} - {{ item.maxCtc }} Lp</span>
                </div>
                <div class="info-row">
                  <span class="info-label">Priority:</span>
                  <span class="info-value" [ngClass]="getPriorityClass(item.priority)">
                    {{ item.priority }}
                  </span>
                </div>
                <div class="info-row">
                  <span class="info-label">Job Type:</span>
                  <span class="info-value">{{ item.jobType }}</span>
                </div>
                <div class="info-row">
                  <span class="info-label">Headcount:</span>
                  <span class="info-value">{{ item.headCount }}</span>
                </div>
              </div>
              <div class="card-actions">
                <button class="btn btn-success btn-sm"  *ngIf="item.status === 'FORWARDED_TO_HR'" (click)="postJob(item.jobRequestId)">
                  <i class="fas fa-upload"></i> Post Job
                </button>
              </div>
            </div>
        }
    </section>
</div>
</body>
</html>